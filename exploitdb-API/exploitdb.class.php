<?php
class ExploitDB {
    private $db;

    public function __construct($db_file) {
        $this->db = new SQLite3($db_file);
    }

    public function searchByCVE($cve_id) {
        $stmt = $this->db->prepare('SELECT * FROM exploits WHERE cve_id = :cve_id');
        $stmt->bindValue(':cve_id', $cve_id, SQLITE3_TEXT);
        $result = $stmt->execute();
        
        $exploits = [];
        while ($row = $result->fetchArray(SQLITE3_ASSOC)) {
            $exploits[] = $row;
        }

        return $exploits;
    }

    public function searchByTitle($title) {
        $stmt = $this->db->prepare('SELECT * FROM exploits WHERE title LIKE :title');
        $stmt->bindValue(':title', '%' . $title . '%', SQLITE3_TEXT);
        $result = $stmt->execute();
        
        $exploits = [];
        while ($row = $result->fetchArray(SQLITE3_ASSOC)) {
            $exploits[] = $row;
        }

        return $exploits;
    }
}
?>