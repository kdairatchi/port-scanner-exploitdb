# port-scanner-exploitdb
Here’s a guide on how to create a perfect GitHub repository with all the files and information you need to set up a port scanner with Exploit-DB vulnerability detection.

### Steps to Create the GitHub Repository

1. **Create a New Repository on GitHub**:
   - Go to GitHub and create a new repository by clicking the “New” button.
   - Name the repository something like `port-scanner-exploitdb`.
   - Add a `README.md`, `.gitignore`, and a license (MIT or any other open source license).
   
2. **Create the Repository Structure**:
   - Organize the repository into folders and files as shown below:

```
port-scanner-exploitdb/
├── exploits/                        # Folder for storing downloaded exploits
├── scripts/                         # Folder for the port scanning and exploit syncing scripts
│   ├── port_scanner.py              # The main Python script for port scanning and exploit fetching
│   ├── exploitdb_sync.sh            # Script to sync the exploits from Exploit-DB
│   └── install.sh                   # Installation script
├── update-db.php                    # Script for updating the SQLite database from Exploit-DB
├── exploitdb-API/                   # Folder for the Exploit-DB API integration
│   ├── API.php                      # The HTTP API to search the exploits by CVE, etc.
│   ├── exploitdb.class.php          # The class that handles the Exploit-DB logic
│   └── README.md                    # Documentation for how the exploitdb-API works
├── .gitignore                       # Git ignore file to exclude unnecessary files
├── README.md                        # Main documentation file for your project
└── LICENSE                          # Open-source license
```

### Step 1: Create the Main Python Script (`port_scanner.py`)

This script will perform the port scanning and vulnerability detection. Add the following code to `port_scanner.py`:

```python
import socket
import argparse
import requests

# API URL for Exploit-DB (running on localhost)
EXPLOIT_DB_API_URL = "http://localhost:8080/API.php"

def fetch_exploit_data_by_cve(cve_id):
    try:
        response = requests.get(f"{EXPLOIT_DB_API_URL}?CVE={cve_id}")
        response.raise_for_status()
        return response.json()
    except requests.RequestException as e:
        print(f"Error fetching exploit data: {e}")
        return None

def scan_port(host, port, verbose):
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.settimeout(1)
            result = sock.connect_ex((host, port))
            if result == 0:
                if verbose:
                    print(f"[+] Port {port} is open on {host}")
                return port
            else:
                if verbose:
                    print(f"[-] Port {port} is closed on {host}")
                return None
    except socket.error as e:
        if verbose:
            print(f"[!] Could not connect to {host}:{port} - {e}")
        return None

def detect_os(open_ports):
    if 22 in open_ports:
        return "Linux (SSH)"
    elif 80 in open_ports or 443 in open_ports:
        return "Web Server (Linux/Windows)"
    elif 135 in open_ports:
        return "Windows (RPC)"
    return "Unknown OS"

def check_vulnerabilities(open_ports):
    vulnerabilities_found = {}
    for port in open_ports:
        cve_id = f"CVE-XXXX-YYYY"  # Replace with actual logic to map ports to CVEs
        exploit_data = fetch_exploit_data_by_cve(cve_id)
        if exploit_data:
            vulnerabilities_found[port] = exploit_data
    return vulnerabilities_found

def scan_ports(host, start_port, end_port, verbose):
    open_ports = []
    for port in range(start_port, end_port + 1):
        result = scan_port(host, port, verbose)
        if result is not None:
            open_ports.append(result)
    return open_ports

def display_results(open_ports):
    if open_ports:
        os_detected = detect_os(open_ports)
        print(f"\n[+] Open ports: {open_ports}")
        print(f"[+] Detected OS: {os_detected}")
        vulnerabilities = check_vulnerabilities(open_ports)
        if vulnerabilities:
            print("[+] Potential vulnerabilities found:")
            for port, details in vulnerabilities.items():
                print(f"   Port {port}: {details}")
        else:
            print("[-] No known vulnerabilities found.")
    else:
        print("\n[-] No open ports found.")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='Port Scanner with Exploit-DB Vulnerability Detection')
    parser.add_argument('host', help='Host to scan (e.g., 192.168.1.1)')
    parser.add_argument('start_port', type=int, help='Starting port number (e.g., 1)')
    parser.add_argument('end_port', type=int, help='Ending port number (e.g., 1024)')
    parser.add_argument('-v', '--verbose', action='store_true', help='Enable verbose output')

    args = parser.parse_args()

    print(f"Scanning {args.host} from port {args.start_port} to {args.end_port}...")
    open_ports = scan_ports(args.host, args.start_port, args.end_port, args.verbose)
    display_results(open_ports)
```

### Step 2: Sync Exploits with Exploit-DB (`exploitdb_sync.sh`)

This script will sync exploits from the Exploit-DB GitHub repository.

```bash
#!/bin/bash
# Sync Exploit-DB
git clone https://github.com/offensive-security/exploitdb.git ./exploits
cd ./exploits
git pull origin master

# Run the PHP script to update the local SQLite DB
php ../update-db.php
```

### Step 3: Installation Script (`install.sh`)

This script will handle installing the dependencies for the project.

```bash
#!/bin/bash
# Installation Script for Port Scanner with Exploit-DB Integration

# Install necessary packages
sudo apt-get update
sudo apt-get install -y python3-pip sqlite3 php git

# Install Python dependencies
pip3 install requests

# Clone and sync Exploit-DB repository
./exploitdb_sync.sh

# Start the local PHP server for the API
php -S localhost:8080 -t ./exploitdb-API &
```

### Step 4: Update Database Script (`update-db.php`)

This script will handle updating the SQLite database with data from Exploit-DB.

```php
<?php
// update-db.php
// This script syncs the local SQLite database with Exploit-DB

$database = new SQLite3('exploitdb.db');
$exploit_dir = './exploits/';

function update_exploit_db($exploit_dir, $database) {
    // Logic to read exploits and update the database
    // Loop through exploit files and update the DB with relevant data
}

update_exploit_db($exploit_dir, $database);

echo "Database updated successfully!";
?>
```

### Step 5: API for Searching Exploits (`API.php`)

This script provides the HTTP API to search exploits by CVE or other identifiers.

```php
<?php
// API.php

header('Content-Type: application/json');

$database = new SQLite3('exploitdb.db');

if (isset($_GET['CVE'])) {
    $cve = $_GET['CVE'];
    $results = $database->query("SELECT * FROM exploits WHERE cve LIKE '%$cve%'");
    
    $exploits = [];
    while ($row = $results->fetchArray(SQLITE3_ASSOC)) {
        $exploits[] = $row;
    }
    
    echo json_encode($exploits);
} else {
    echo json_encode(["error" => "Invalid query"]);
}
?>
```

### Step 6: Add Documentation (`README.md`)

Here’s an example `README.md` file that explains how to use the repository:

```md
# Port Scanner with Exploit-DB Vulnerability Detection

This project is a port scanner that detects open ports on a target host and checks for related vulnerabilities using data from Exploit-DB.

## Features
- Port scanning for open ports
- Detect operating system based on open ports
- Fetch potential exploits from Exploit-DB
- Auto-sync with Exploit-DB repository to update vulnerability data

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/port-scanner-exploitdb.git
   cd port-scanner-exploitdb
   ```

2. Run the installation script:
   ```bash
   ./install.sh
   ```

3. Sync exploits with Exploit-DB:
   ```bash
   ./exploitdb_sync.sh
   ```

## Usage

To run the port scanner, use the following command:

```bash
python3 scripts/port_scanner.py <host> <start_port> <end_port> [-v]
```

Example:

```bash
python3 scripts/port_scanner.py 192.168.1.1 1 1024 -v
```

This will scan the host `192.168.1.1` for open ports between 1 and 1024, and check for related exploits from Exploit-DB.

## API

The local Exploit-DB API can be accessed at `http://localhost:8080`. To search for an exploit by CVE, use:

```
http://
