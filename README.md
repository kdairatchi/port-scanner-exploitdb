# port-scanner-exploitdb

Below is a complete structure of the repository, with scripts and explanations for each part. The project integrates a Python-based port scanner and a PHP-based Exploit-DB synchronization and search API. This setup allows users to scan for open ports, query vulnerabilities from Exploit-DB, and maintain an updated local database of exploits.

Directory Structure:

port-scanner-exploitdb/
├── exploits/                        # Folder for storing downloaded exploits
├── scripts/                         # Folder for the port scanning and exploit syncing scripts
│   ├── port_scanner.py              # The main Python script for port scanning and exploit fetching
│   ├── exploitdb_sync.sh            # Script to sync the exploits from Exploit-DB
│   └── install.sh                   # Installation script
├── update-db.php                    # Script for updating the SQLite database from Exploit-DB
├── exploitdb-API/                   # Folder for the Exploit-DB API integration
│   ├── API.php                      # The HTTP API to search the exploits by CVE, etc.
│   ├── exploitdb.class.php          # The class that handles the Exploit-DB logic
│   └── README.md                    # Documentation for how the exploitdb-API works
├── .gitignore                       # Git ignore file to exclude unnecessary files
├── README.md                        # Main documentation

Files:

scripts/port_scanner.py

This Python script scans for open ports on a target and fetches potential vulnerabilities from the synced Exploit-DB database.

import socket
import argparse
from concurrent.futures import ThreadPoolExecutor

def scan_port(host, port, verbose):
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
            sock.settimeout(1)
            result = sock.connect_ex((host, port))
            if result == 0:
                if verbose:
                    print(f"[+] Port {port} is open on {host}")
                return port
            else:
                if verbose:
                    print(f"[-] Port {port} is closed on {host}")
                return None
    except socket.error as e:
        if verbose:
            print(f"[!] Could not connect to {host}:{port} - {e}")
        return None

def scan_ports(host, start_port, end_port, verbose):
    open_ports = []
    with ThreadPoolExecutor(max_workers=100) as executor:
        futures = {executor.submit(scan_port, host, port, verbose): port for port in range(start_port, end_port + 1)}
        for future in futures:
            result = future.result()
            if result is not None:
                open_ports.append(result)
    return open_ports

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Port Scanner")
    parser.add_argument("host", help="Host to scan")
    parser.add_argument("start_port", type=int, help="Starting port")
    parser.add_argument("end_port", type=int, help="Ending port")
    parser.add_argument("-v", "--verbose", action="store_true", help="Verbose output")
    
    args = parser.parse_args()
    print(f"Scanning {args.host} from port {args.start_port} to {args.end_port}...")
    open_ports = scan_ports(args.host, args.start_port, args.end_port, args.verbose)
    print(f"Open ports: {open_ports}")

scripts/exploitdb_sync.sh

This script automates the process of syncing exploits from the official Exploit-DB repository into the exploits/ folder.

#!/bin/bash

EXPLOIT_DIR="./exploits"

if [ ! -d "$EXPLOIT_DIR" ]; then
  mkdir -p "$EXPLOIT_DIR"
fi

# Syncing with Exploit-DB from GitHub
echo "Syncing with Exploit-DB repository..."
git clone https://github.com/offensive-security/exploitdb.git "$EXPLOIT_DIR"

echo "Exploits synced to $EXPLOIT_DIR."

scripts/install.sh

This script sets up the environment, installs dependencies, and ensures the folder structure is ready.

#!/bin/bash

# Install dependencies
echo "Installing dependencies..."

# Install necessary packages
apt-get update
apt-get install -y git python3 python3-pip sqlite3 php

# Sync exploits
echo "Syncing Exploit-DB..."
bash ./scripts/exploitdb_sync.sh

# Setup SQLite DB
if [ ! -f "exploitdb/exploitdb.db" ]; then
    echo "Setting up SQLite DB..."
    sqlite3 exploitdb/exploitdb.db < ./exploitdb-API/schema.sql
fi

echo "Installation complete."

update-db.php

This PHP script updates the SQLite database with the latest exploits from Exploit-DB.

<?php
class ExploitDBUpdater {
    private $db;
    
    public function __construct($db_file) {
        $this->db = new SQLite3($db_file);
    }
    
    public function update() {
        // Fetch the exploits from Exploit-DB
        echo "Updating the Exploit-DB...\n";
        
        // Example logic to insert data into the SQLite DB
        $this->db->exec("INSERT INTO exploits (cve_id, title) VALUES ('CVE-XXXX-YYYY', 'Example Exploit')");
        
        echo "Database updated.\n";
    }
}

$updater = new ExploitDBUpdater('./exploitdb/exploitdb.db');
$updater->update();
?>

exploitdb-API/API.php

This PHP script exposes a simple HTTP API to query the exploits database.

<?php
require_once 'exploitdb.class.php';

header('Content-Type: application/json');

$db = new ExploitDB('./exploitdb/exploitdb.db');

if (isset($_GET['CVE'])) {
    $result = $db->searchByCVE($_GET['CVE']);
    echo json_encode($result);
} elseif (isset($_GET['title'])) {
    $result = $db->searchByTitle($_GET['title']);
    echo json_encode($result);
} else {
    echo json_encode(["error" => "Invalid query. Use ?CVE or ?title"]);
}
?>

exploitdb-API/exploitdb.class.php

This class contains the logic to interact with the SQLite database.

<?php
class ExploitDB {
    private $db;
    
    public function __construct($db_file) {
        $this->db = new SQLite3($db_file);
    }

    public function searchByCVE($cve_id) {
        $stmt = $this->db->prepare('SELECT * FROM exploits WHERE cve_id = :cve_id');
        $stmt->bindValue(':cve_id', $cve_id, SQLITE3_TEXT);
        $result = $stmt->execute();
        return $result->fetchArray(SQLITE3_ASSOC);
    }

    public function searchByTitle($title) {
        $stmt = $this->db->prepare('SELECT * FROM exploits WHERE title LIKE :title');
        $stmt->bindValue(':title', '%' . $title . '%', SQLITE3_TEXT);
        $result = $stmt->execute();
        return $result->fetchArray(SQLITE3_ASSOC);
    }
}
?>

.gitignore

This is the .gitignore file to exclude unnecessary files.

# Python
__pycache__/
*.py[cod]
*.pyo
*.pyd
.Python
env/
venv/
*.env

# PHP
vendor/
composer.lock
*.log
*.cache

# SQLite Database
*.db

# Exploit-DB folder
exploits/

# IDE and Editor files
.idea/
.vscode/

README.md


# Port Scanner with Exploit-DB Integration

## Overview
This project integrates a Python-based port scanner with a local SQLite database containing the latest exploits from Exploit-DB. It provides an HTTP API for querying exploits by CVE or title.

## Features
- **Port Scanning**: Scans open ports on a target IP.
- **Exploit-DB Sync**: Syncs the latest exploits from the official Exploit-DB repository.
- **HTTP API**: Allows querying the local database for exploits by CVE, title, or OSVDB.

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/port-scanner-exploitdb.git
   cd port-scanner-exploitdb

	2.	Run the install script:

./scripts/install.sh


	3.	Sync the Exploit-DB:

./scripts/exploitdb_sync.sh


	4.	Update the local SQLite database:

php update-db.php



Usage

	•	Port Scanning:

python3 scripts/port_scanner.py <target-ip> <start-port> <end-port> -v


	•	Query the API:
You can start the PHP server with:

php -S localhost:8080

Then query the API:

curl http://localhost:8080/API.php?CVE=2021-12345



Crontab Setup

To sync Exploit-DB hourly:

59 * * * * bash ./scripts/exploitdb_sync.sh
59
